{
    "@type": "Workflow",
    "triggerLimit": null,
    "name": "OTbase Inventory > Link ICS Advisory to Assets",
    "aliasName": null,
    "tag": null,
    "description": "Links ICS Advisory to Assets",
    "isActive": true,
    "debug": false,
    "singleRecordExecution": false,
    "remoteExecutableFlag": false,
    "parameters": [],
    "synchronous": false,
    "collection": "\/api\/3\/workflow_collections\/8dbc991d-05bb-45cd-9221-1271f9c06642",
    "versions": [],
    "triggerStep": "\/api\/3\/workflow_steps\/e9b4cd3f-3c11-4f22-879a-48597ecd94c4",
    "steps": [
        {
            "@type": "WorkflowStep",
            "name": "Check if Matching ICS Advisory is found",
            "description": null,
            "arguments": {
                "conditions": [
                    {
                        "option": "Yes",
                        "step_iri": "\/api\/3\/workflow_steps\/315cb18a-e1ae-4ee7-8e60-590a7d11b652",
                        "condition": "{{ vars.steps.Fuzzy_Search_using_Product.data | length > 0 }}",
                        "step_name": "Get ICS IDs"
                    },
                    {
                        "option": "No",
                        "default": true,
                        "step_iri": "\/api\/3\/workflow_steps\/0c3d7dbc-5343-417b-9d22-2ec860764683",
                        "step_name": "No Operation"
                    }
                ],
                "step_variables": []
            },
            "status": null,
            "top": "570",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/12254cf5-5db7-4b1a-8cb1-3af081924b28",
            "group": null,
            "uuid": "e25bfde0-e5a8-4bfb-b2ae-1122096d1f5d"
        },
        {
            "@type": "WorkflowStep",
            "name": "Configuration",
            "description": null,
            "arguments": [],
            "status": null,
            "top": "165",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "1e3ca470-0d32-4e2b-9721-81b797e34e57"
        },
        {
            "@type": "WorkflowStep",
            "name": "Fetch ICS Advisories",
            "description": null,
            "arguments": {
                "query": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "primitive",
                            "field": "vendor",
                            "value": "%{{vars.input.records[0].vendor}}%",
                            "operator": "like",
                            "_operator": "like"
                        }
                    ]
                },
                "module": "i_c_s_advisories?$limit=300",
                "step_variables": []
            },
            "status": null,
            "top": "300",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928770",
            "group": null,
            "uuid": "059d1662-36af-4cae-ba7a-9391004326bf"
        },
        {
            "@type": "WorkflowStep",
            "name": "Fuzzy Search using Product",
            "description": null,
            "arguments": {
                "name": "Fuzzy Search",
                "params": {
                    "cutoff": 75,
                    "inputJSON": "{{vars.steps.Fetch_ICS_Advisories}}",
                    "fuzzyMatch": true,
                    "targetKeyValue": "{'product':\"{{vars.input.records[0].product}}\"}",
                    "similarityThreshold": 75
                },
                "version": "1.0.0",
                "connector": "fuzzy-search",
                "operation": "filter_json_by_key_value",
                "ignore_errors": true,
                "operationTitle": "Filter JSON by Key Value",
                "pickFromTenant": false,
                "step_variables": []
            },
            "status": null,
            "top": "435",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/0bfed618-0316-11e7-93ae-92361f002671",
            "group": null,
            "uuid": "a832ee7a-da54-49a8-b3fa-b4a8a49b54d2"
        },
        {
            "@type": "WorkflowStep",
            "name": "Get ICS IDs",
            "description": null,
            "arguments": {
                "ics_ids": "{{vars.steps.Fuzzy_Search_using_Product.data | json_query('[*][\"@id\"]') | sum(start=[]) }}"
            },
            "status": null,
            "top": "705",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/04d0cf46-b6a8-42c4-8683-60a7eaa69e8f",
            "group": null,
            "uuid": "315cb18a-e1ae-4ee7-8e60-590a7d11b652"
        },
        {
            "@type": "WorkflowStep",
            "name": "Link Asset and ICS Advisories",
            "description": null,
            "arguments": {
                "resource": {
                    "__link": {
                        "iCSAdvisories": "{{vars.ics_ids}}"
                    }
                },
                "operation": "Append",
                "collection": "{{vars.input.records[0]['@id']}}",
                "__recommend": [],
                "collectionType": "\/api\/3\/assets",
                "fieldOperation": [],
                "step_variables": []
            },
            "status": null,
            "top": "840",
            "left": "475",
            "stepType": "\/api\/3\/workflow_step_types\/b593663d-7d13-40ce-a3a3-96dece928722",
            "group": null,
            "uuid": "314af263-cf74-4fd9-b35e-8e8316da876e"
        },
        {
            "@type": "WorkflowStep",
            "name": "No Operation",
            "description": null,
            "arguments": {
                "params": [],
                "version": "3.2.6",
                "connector": "cyops_utilities",
                "operation": "no_op",
                "operationTitle": "Utils: No Operation",
                "step_variables": []
            },
            "status": null,
            "top": "705",
            "left": "125",
            "stepType": "\/api\/3\/workflow_step_types\/0109f35d-090b-4a2b-bd8a-94cbc3508562",
            "group": null,
            "uuid": "0c3d7dbc-5343-417b-9d22-2ec860764683"
        },
        {
            "@type": "WorkflowStep",
            "name": "Start",
            "description": null,
            "arguments": {
                "resource": "assets",
                "resources": [
                    "assets"
                ],
                "__triggerLimit": true,
                "step_variables": {
                    "input": {
                        "params": [],
                        "records": [
                            "{{vars.input.records[0]}}"
                        ]
                    }
                },
                "triggerOnSource": true,
                "fieldbasedtrigger": {
                    "sort": [],
                    "limit": 30,
                    "logic": "AND",
                    "filters": [
                        {
                            "type": "array",
                            "field": "recordTags",
                            "value": [
                                "\/api\/3\/tags\/otbase-inventory"
                            ],
                            "module": "recordTags",
                            "display": null,
                            "operator": "in",
                            "template": "tags",
                            "OPERATOR_KEY": "$",
                            "useInOperator": true,
                            "previousOperator": "in",
                            "previousTemplate": "tags"
                        }
                    ]
                },
                "triggerOnReplicate": false
            },
            "status": null,
            "top": "30",
            "left": "300",
            "stepType": "\/api\/3\/workflow_step_types\/ea155646-3821-4542-9702-b246da430a8d",
            "group": null,
            "uuid": "e9b4cd3f-3c11-4f22-879a-48597ecd94c4"
        }
    ],
    "routes": [
        {
            "@type": "WorkflowRoute",
            "name": "Check if ICS Advisory is found -> No Operation",
            "targetStep": "\/api\/3\/workflow_steps\/0c3d7dbc-5343-417b-9d22-2ec860764683",
            "sourceStep": "\/api\/3\/workflow_steps\/e25bfde0-e5a8-4bfb-b2ae-1122096d1f5d",
            "label": "No",
            "isExecuted": false,
            "group": null,
            "uuid": "00a28c1d-f117-4325-964f-d6f3c2d1fc37"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Check if Matching ICS Advisory is found -> Get ICS IDs",
            "targetStep": "\/api\/3\/workflow_steps\/315cb18a-e1ae-4ee7-8e60-590a7d11b652",
            "sourceStep": "\/api\/3\/workflow_steps\/e25bfde0-e5a8-4bfb-b2ae-1122096d1f5d",
            "label": "Yes",
            "isExecuted": false,
            "group": null,
            "uuid": "8227c8c1-d572-4452-b1e1-af0a5ae27275"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Configuration -> Fetch ICS Advisories",
            "targetStep": "\/api\/3\/workflow_steps\/059d1662-36af-4cae-ba7a-9391004326bf",
            "sourceStep": "\/api\/3\/workflow_steps\/1e3ca470-0d32-4e2b-9721-81b797e34e57",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "b771dd1f-f9ad-45d5-a79d-7339e542389f"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Fetch ICS Advisories -> Fuzzy Search using Product",
            "targetStep": "\/api\/3\/workflow_steps\/a832ee7a-da54-49a8-b3fa-b4a8a49b54d2",
            "sourceStep": "\/api\/3\/workflow_steps\/059d1662-36af-4cae-ba7a-9391004326bf",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "91e401ef-5e9a-475f-8a99-9535a52c2739"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Fuzzy Search using Product -> Check if ICS Advisory is found",
            "targetStep": "\/api\/3\/workflow_steps\/e25bfde0-e5a8-4bfb-b2ae-1122096d1f5d",
            "sourceStep": "\/api\/3\/workflow_steps\/a832ee7a-da54-49a8-b3fa-b4a8a49b54d2",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "db0ddce2-3c86-40c5-90bb-50cf2833a79e"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Get ICS IDs -> Link Asset and ICS Advisories",
            "targetStep": "\/api\/3\/workflow_steps\/314af263-cf74-4fd9-b35e-8e8316da876e",
            "sourceStep": "\/api\/3\/workflow_steps\/315cb18a-e1ae-4ee7-8e60-590a7d11b652",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "7a5312c8-f3f4-4cd0-a938-4a2d33fdada8"
        },
        {
            "@type": "WorkflowRoute",
            "name": "Start -> Configuration",
            "targetStep": "\/api\/3\/workflow_steps\/1e3ca470-0d32-4e2b-9721-81b797e34e57",
            "sourceStep": "\/api\/3\/workflow_steps\/e9b4cd3f-3c11-4f22-879a-48597ecd94c4",
            "label": null,
            "isExecuted": false,
            "group": null,
            "uuid": "52e764f8-2ebe-4671-9732-d085c4cb5816"
        }
    ],
    "groups": [],
    "priority": "\/api\/3\/picklists\/2b563c61-ae2c-41c0-a85a-c9709585e3f2",
    "uuid": "0b256633-b114-44b0-b427-357943c70f68",
    "owners": [],
    "isPrivate": false,
    "deletedAt": null,
    "recordTags": [
        "otbase-inventory",
        "PostCreate"
    ]
}